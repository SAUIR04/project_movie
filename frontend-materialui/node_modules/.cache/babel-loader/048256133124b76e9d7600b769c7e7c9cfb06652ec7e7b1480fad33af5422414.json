{"ast":null,"code":"import React,{createContext,useState,useEffect}from'react';import{jwtDecode}from'jwt-decode';import{jsx as _jsx}from\"react/jsx-runtime\";export const AuthContext=/*#__PURE__*/createContext();export const AuthProvider=_ref=>{let{children}=_ref;const[token,setToken]=useState(localStorage.getItem('token'));const[username,setUsername]=useState(localStorage.getItem('username'));const[isAuthenticated,setIsAuthenticated]=useState(false);const[loading,setLoading]=useState(true);useEffect(()=>{const checkAuth=async()=>{try{if(token){const decoded=jwtDecode(token);if(decoded.exp*1000<Date.now()){// Token expired\nlocalStorage.removeItem('token');localStorage.removeItem('username');setToken(null);setUsername('');setIsAuthenticated(false);}else{setIsAuthenticated(true);setUsername(prevUsername=>decoded.username||prevUsername);}}else{setIsAuthenticated(false);}setLoading(false);}catch(error){localStorage.removeItem('token');localStorage.removeItem('username');setToken(null);setUsername('');setIsAuthenticated(false);setLoading(false);}};checkAuth();},[token]);const login=(newToken,newUsername)=>{localStorage.setItem('token',newToken);localStorage.setItem('username',newUsername);setToken(newToken);setUsername(newUsername);setIsAuthenticated(true);};const logout=()=>{localStorage.removeItem('token');localStorage.removeItem('username');setToken(null);setUsername('');setIsAuthenticated(false);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{token,username,isAuthenticated,loading,login,logout},children:children});};","map":{"version":3,"names":["React","createContext","useState","useEffect","jwtDecode","jsx","_jsx","AuthContext","AuthProvider","_ref","children","token","setToken","localStorage","getItem","username","setUsername","isAuthenticated","setIsAuthenticated","loading","setLoading","checkAuth","decoded","exp","Date","now","removeItem","prevUsername","error","login","newToken","newUsername","setItem","logout","Provider","value"],"sources":["/Users/sauirbayseidulla/Desktop/MERN2/frontend-materialui/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport { jwtDecode } from 'jwt-decode';\n\nexport const AuthContext = createContext();\n\nexport const AuthProvider = ({ children }) => {\n    const [token, setToken] = useState(localStorage.getItem('token'));\n    const [username, setUsername] = useState(localStorage.getItem('username'));\n    const [isAuthenticated, setIsAuthenticated] = useState(false);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        const checkAuth = async () => {\n            try {\n                if (token) {\n                    \n                    const decoded = jwtDecode(token);\n                    if (decoded.exp * 1000 < Date.now()) {\n                        // Token expired\n                        localStorage.removeItem('token');\n                        localStorage.removeItem('username');\n                        setToken(null);\n                        setUsername('');\n                        setIsAuthenticated(false);\n                    } else {\n                        setIsAuthenticated(true);\n                        setUsername((prevUsername) => decoded.username || prevUsername);\n                    }\n                } else {\n                    setIsAuthenticated(false);\n                }\n                setLoading(false);\n            } catch (error) {\n                localStorage.removeItem('token');\n                localStorage.removeItem('username');\n                setToken(null);\n                setUsername('');\n                setIsAuthenticated(false);\n                setLoading(false);\n            }\n        };\n\n        checkAuth();\n    }, [token]);\n\n    const login = (newToken, newUsername) => {\n        localStorage.setItem('token', newToken);\n        localStorage.setItem('username', newUsername);\n        setToken(newToken);\n        setUsername(newUsername);\n        setIsAuthenticated(true);\n    };\n\n    const logout = () => {\n        localStorage.removeItem('token');\n        localStorage.removeItem('username');\n        setToken(null);\n        setUsername('');\n        setIsAuthenticated(false);\n    };\n\n    return (\n        <AuthContext.Provider\n            value={{\n                token,\n                username,\n                isAuthenticated,\n                loading,\n                login,\n                logout,\n            }}\n        >\n            {children}\n        </AuthContext.Provider>\n    );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}